[Supabase Init] CWD: /Users/hipoglisemi/Desktop/kartavantaj-scraper
[Supabase Init] __dirname: /Users/hipoglisemi/Desktop/kartavantaj-scraper/src/utils
[Supabase Init] SUPABASE_URL present? true
[Supabase Init] URL Length: 40
[Supabase Init] URL Start: https://cp...
[Supabase Init] URL Valid Protocol? true
ğŸš€ Starting TEB Scraper...
   ğŸ”Œ Connecting to Chrome debug instance on port 9222...
   âš ï¸  Could not connect to debug Chrome, launching new instance...
   ğŸš€ Launching new browser instance (Headless: false)...
   ğŸ” Loading Campaign List: https://www.teb.com.tr/sizin-icin/kampanyalar/...

   ğŸ‰ Found 56 unique campaigns.
   ğŸ” Normalizing bank name...
   âœ… Normalized bank: TEB
   ğŸ” Checking for new and incomplete campaigns in database...
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/giyim-1200/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/market-bonus/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/e-ticaret-600-bonus/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/beyaz-esya-harcamalariniza-bonus/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/fatura-indirim-2026/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/otomotiv-lastik/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/duty-free-400/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/yurtdisi-kampanyasi-500/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/mtv-taksit-kampanyasi/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/igdas-odemelerinize-taksit/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/yapi-market-1000/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/mobilya-1200/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/istanbulkart/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/debit-market-kampanyasi/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/restoran-harcama-kampanyasi/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/debit-ulasim-indirim/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/akaryakit-indirim/
      âš ï¸  Incomplete (image_missing, brand_missing): https://www.teb.com.tr/sizin-icin/saglik-taksit/
      âš ï¸  Incomplete (image_missing, brand_missing): https://www.teb.com.tr/sizin-icin/hosgeldin-kredisi/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/avantajli-kredi/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/cepteteb-nakit-firsati/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/my-visa-taksi/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/my-visa-otel/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/my-visa-restoran/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/vitruta/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/gardrops/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/walkersapp/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/osevio/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/e-sim/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/n11-indirim/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/google-play-indirim/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/ooautos/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/enuygun-otel-indirim/
      âš ï¸  Incomplete (image_missing): https://www.teb.com.tr/sizin-icin/enuygun-arac-y10-indirim/
   ğŸ“Š Total: 56, New: 22, Incomplete: 34, Complete: 0
   ğŸš€ Processing 56 campaigns (22 new + 34 incomplete)...
   ğŸš€ Processing details for 56 campaigns (skipping 0 complete/existing)...

   ğŸ” Processing [1/56]: https://www.teb.com.tr/sizin-icin/giyim-1200/
ğŸ“š Supabase'den ana veriler Ã§ekiliyor...
âœ… Veriler YÃ¼klendi: 18 kategori, 671 marka, 12 banka
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 10102 tokens (P: 9286, C: 816) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [1] Giyim AlÄ±ÅŸveriÅŸlerinize Toplam 1.20... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [2/56]: https://www.teb.com.tr/sizin-icin/market-bonus/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 22778 tokens (P: 9240, C: 2430) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [2] Market ve GÄ±da HarcamalarÄ±nÄ±za Topl... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [3/56]: https://www.teb.com.tr/sizin-icin/e-ticaret-600-bonus/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 10051 tokens (P: 9377, C: 674) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [3] E-Ticaret HarcamalarÄ±nÄ±za Toplam 60... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [4/56]: https://www.teb.com.tr/sizin-icin/beyaz-esya-harcamalariniza-bonus/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9908 tokens (P: 9322, C: 586) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [4] Beyaz EÅŸya ve Elektronik AlÄ±ÅŸveriÅŸi... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [5/56]: https://www.teb.com.tr/sizin-icin/marifetli-kampanyasi/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 10106 tokens (P: 9593, C: 513) [PYTHON]
   ğŸ”„ Stage 2: Filling missing fields: valid_until 
   ğŸ“Š AI Usage: 1916 tokens (P: 1900, C: 16) [PYTHON]
   âœ… Stage 2: Complete
   âš ï¸  WARNING: Still missing critical fields: valid_until 
      [5] Marifetli Hesap 30+30+30 HoÅŸ Geldin... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [6/56]: https://www.teb.com.tr/sizin-icin/fatura-indirim-2026/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9794 tokens (P: 9282, C: 512) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      ğŸ·ï¸  Generic campaign detected: "Otomatik Fatura Ã–deme TalimatlarÄ±nÄ±za %20 Ä°ndirim"
      [6] Otomatik Fatura Ã–deme TalimatlarÄ±nÄ±... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [7/56]: https://www.teb.com.tr/sizin-icin/otomotiv-lastik/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9858 tokens (P: 9245, C: 613) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [7] Otomotiv HarcamanÄ±za 750 TLâ€™ye Vara... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [8/56]: https://www.teb.com.tr/sizin-icin/duty-free-400/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9754 tokens (P: 9173, C: 581) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [8] Duty Free HarcamalarÄ±nÄ±za Toplam 40... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [9/56]: https://www.teb.com.tr/sizin-icin/yurtdisi-kampanyasi-500/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9863 tokens (P: 9178, C: 685) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [9] Yurt DÄ±ÅŸÄ± HarcamanÄ±za 500 TL Bonus!... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [10/56]: https://www.teb.com.tr/sizin-icin/mtv-taksit-kampanyasi/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9508 tokens (P: 8929, C: 579) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [10] MTV Ã–demelerinize 4 Taksit FÄ±rsatÄ±!... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [11/56]: https://www.teb.com.tr/sizin-icin/igdas-odemelerinize-taksit/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9636 tokens (P: 8951, C: 685) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [11] Ä°gdaÅŸ Ã–demelerinize Faizsiz 3 Taksi... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [12/56]: https://www.teb.com.tr/sizin-icin/yapi-market-1000/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9939 tokens (P: 9332, C: 607) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [12] YapÄ± Market HarcamanÄ±za 1.000 TL'ye... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [13/56]: https://www.teb.com.tr/sizin-icin/mobilya-1200/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 10041 tokens (P: 9209, C: 832) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [13] Mobilya HarcamanÄ±za 1.200 TL Bonus!... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [14/56]: https://www.teb.com.tr/sizin-icin/bonus-akaryakit-kampanyasi/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9763 tokens (P: 9133, C: 630) [PYTHON]
   âš ï¸  Error: AI returned but no valid JSON object was found in multi-part response.. Retry 1/3 after 2000ms...
   ğŸ“Š AI Usage: 9829 tokens (P: 9133, C: 696) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [14] AkaryakÄ±t HarcamalarÄ±nÄ±za Toplam 20... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [15/56]: https://www.teb.com.tr/sizin-icin/istanbulkart/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9761 tokens (P: 9121, C: 640) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
   âš ï¸  Brand Lookup Failed: "Ä°stanbulkart"
      [15] Ä°stanbulkart YÃ¼klemelerinize Toplam... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [16/56]: https://www.teb.com.tr/sizin-icin/debit-market-kampanyasi/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9764 tokens (P: 9127, C: 637) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [16] TEB Bireysel Banka KartlarÄ± ile Mar... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [17/56]: https://www.teb.com.tr/sizin-icin/egitim-taksit/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9891 tokens (P: 9357, C: 534) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
   âš ï¸  Validation errors detected:
      ğŸš¨ MantÄ±k hatasÄ±! max_discount (2000000) > min_spend (10000)
   ğŸ”„ Triggering Surgical Parse to fix issues...
   ğŸ“Š AI Usage: 1909 tokens (P: 1788, C: 121) [PYTHON]
   âš ï¸  WARNING: Still has validation errors after surgical fix:
      ğŸš¨ MantÄ±k hatasÄ±! max_discount (2000000) > min_spend (10000)
      [17] EÄŸitim Ã–demelerinize Faizsiz 4 Taks... (Img: âœ…)
      âŒ DB Error for "EÄŸitim Ã–demelerinize Faizsiz 4 Taksit!": Could not find the 'sms_code' column of 'campaigns' in the schema cache
   ğŸ” Processing [18/56]: https://www.teb.com.tr/sizin-icin/giyim-kampanyasi/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9767 tokens (P: 9141, C: 626) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [18] TEB Bireysel Banka KartlarÄ± ile Giy... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [19/56]: https://www.teb.com.tr/sizin-icin/elektronik-harcamalarina-indirim/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 19668 tokens (P: 9116, C: 1070) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [19] TEB Bireysel Banka KartlarÄ± ile Ele... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [20/56]: https://www.teb.com.tr/sizin-icin/restoran-harcama-kampanyasi/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9703 tokens (P: 9072, C: 631) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [20] TEB Bireysel Banka KartlarÄ± ile Res... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [21/56]: https://www.teb.com.tr/sizin-icin/debit-ulasim-indirim/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9944 tokens (P: 9278, C: 666) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [21] TEB Banka KartlarÄ± ile Toplu UlaÅŸÄ±m... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [22/56]: https://www.teb.com.tr/sizin-icin/akaryakit-indirim/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 23376 tokens (P: 9055, C: 2968) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [22] TEB Bireysel Banka KartlarÄ± ile Aka... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [23/56]: https://www.teb.com.tr/sizin-icin/pegasus/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9821 tokens (P: 9242, C: 579) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [23] Pegasus'ta 500 TL Bonus!... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [24/56]: https://www.teb.com.tr/sizin-icin/emekliye-ozel-promosyon/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 10996 tokens (P: 10364, C: 632) [PYTHON]
   ğŸ”„ Stage 2: Filling missing fields: valid_until 
   ğŸ“Š AI Usage: 2687 tokens (P: 2671, C: 16) [PYTHON]
   âœ… Stage 2: Complete
   âš ï¸  WARNING: Still missing critical fields: valid_until 
      [24] 21.000 TL'ye Varan Promosyon... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [25/56]: https://www.teb.com.tr/sizin-icin/emekli-market/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9568 tokens (P: 9132, C: 436) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [25] TEB Bonus Emekli KartÄ±nÄ±za Ã–zel Mar... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [26/56]: https://www.teb.com.tr/sizin-icin/saglik-taksit/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9590 tokens (P: 9127, C: 463) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [26] TEB Bonus Emekli Kart'a Ã–zel Hastan... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [27/56]: https://www.teb.com.tr/sizin-icin/2025-cekilis-sonuclari/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9466 tokens (P: 9047, C: 419) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [27] 15 Adet iPhone 16 Sahiplerini Buldu... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [28/56]: https://www.teb.com.tr/sizin-icin/thy-500-indirim/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9956 tokens (P: 9475, C: 481) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      ğŸ·ï¸  Generic campaign detected: "TROY Logolu TEB KartlarÄ± ile TÃ¼rk Hava YollarÄ± Biletlerinde 500 TL Ä°ndirim"
      [28] TROY Logolu TEB KartlarÄ± ile TÃ¼rk H... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [29/56]: https://www.teb.com.tr/sizin-icin/enuygun-indirim/
   gemini-2.0-flash Stage 1: Full parse...
   ğŸ“Š AI Usage: 9260 tokens (P: 8717, C: 543)
   âœ… Stage 1: Complete (all fields extracted)
      [29] TEB Mastercard Logolu Kredi Kartlar... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [30/56]: https://www.teb.com.tr/sizin-icin/hosgeldin-kredisi/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9703 tokens (P: 9249, C: 454) [PYTHON]
   ğŸ”„ Stage 2: Filling missing fields: valid_until 
   ğŸ“Š AI Usage: 1572 tokens (P: 1556, C: 16) [PYTHON]
   âœ… Stage 2: Complete
   âš ï¸  WARNING: Still missing critical fields: valid_until 
      [30] TEB'den HoÅŸ Geldin Kredisi!... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [31/56]: https://www.teb.com.tr/sizin-icin/autoking-y20/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9232 tokens (P: 8716, C: 516) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
   âš ï¸  Validation errors detected:
      ğŸš¨ Matematiksel tutarsÄ±zlÄ±k! discount_percentage=20 ama min_spend=NULL
   ğŸ”„ Triggering Surgical Parse to fix issues...
   ğŸ“Š AI Usage: 1250 tokens (P: 1147, C: 103) [PYTHON]
   ğŸ†• New brands detected: Auto King
   âœ… Added new brand: Auto King
   âš ï¸  WARNING: Still has validation errors after surgical fix:
      ğŸš¨ Matematiksel tutarsÄ±zlÄ±k! discount_percentage=20 ama min_spend=NULL
      [31] Auto King Servis Merkezleri'nde %20... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [32/56]: https://www.teb.com.tr/sizin-icin/avantajli-kredi/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 36612 tokens (P: 9296, C: 3793) [PYTHON]
   ğŸ”„ Stage 2: Filling missing fields: valid_until 
   ğŸ“Š AI Usage: 1620 tokens (P: 1604, C: 16) [PYTHON]
   ğŸ¦ Bank service detected for "TEB Ä°htiyaÃ§ Kredisi KampanyasÄ±", mapping to "Genel"
   âœ… Stage 2: Complete
   âš ï¸  WARNING: Still missing critical fields: valid_until 
      ğŸ·ï¸  Generic campaign detected: "%2,99'dan BaÅŸlayan Faiz OranÄ±yla 125.000 TL 36 Ay Vadeli Ä°htiyaÃ§ Kredisi"
      [32] %2,99'dan BaÅŸlayan Faiz OranÄ±yla 12... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [33/56]: https://www.teb.com.tr/sizin-icin/cepteteb-nakit-firsati/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 10335 tokens (P: 9734, C: 601) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      ğŸ·ï¸  Generic campaign detected: "150.000 TL'ye Varan Nakit FÄ±rsatÄ±!"
      [33] 150.000 TL'ye Varan Nakit FÄ±rsatÄ±!... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [34/56]: https://www.teb.com.tr/sizin-icin/my-visa-taksi/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 47824 tokens (P: 10570, C: 6861) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [34] Avrupa ve Amerika'daki Taksi ve Ã–ze... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [35/56]: https://www.teb.com.tr/sizin-icin/my-visa-otel/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 11183 tokens (P: 10612, C: 571) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
   âš ï¸  Validation errors detected:
      âš ï¸  Min_spend hesaplama uyarÄ±sÄ±: Beklenen ~30000 TL, bulunan 25000 TL
   ğŸ”„ Triggering Surgical Parse to fix issues...
      [35] Avrupa ve Amerika'daki Otel Harcama... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [36/56]: https://www.teb.com.tr/sizin-icin/my-visa-restoran/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 11248 tokens (P: 10646, C: 602) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [36] Avrupa ve Amerika'daki Restoran Har... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [37/56]: https://www.teb.com.tr/sizin-icin/vitruta/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9448 tokens (P: 8987, C: 461) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
   âš ï¸  Validation errors detected:
      ğŸš¨ Matematiksel tutarsÄ±zlÄ±k! discount_percentage=15 ama min_spend=NULL
   ğŸ”„ Triggering Surgical Parse to fix issues...
   ğŸ“Š AI Usage: 1551 tokens (P: 1425, C: 126) [PYTHON]
   ğŸ†• New brands detected: Dr. Martens
   âœ… Added new brand: Dr. Martens
   âš ï¸  WARNING: Still has validation errors after surgical fix:
      ğŸš¨ Matematiksel tutarsÄ±zlÄ±k! discount_percentage=15 ama min_spend=NULL
      [37] My Visa'lÄ±lara Ã–zel Vitruta'da %15 ... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [38/56]: https://www.teb.com.tr/sizin-icin/gardrops/
   gemini-2.0-flash Stage 1: Full parse...
   ğŸ“Š AI Usage: 8997 tokens (P: 8425, C: 572)
   ğŸ”„ Stage 2: Filling missing fields: valid_until 
   ğŸ“Š AI Usage: 1167 tokens (P: 1151, C: 16)
   âœ… Stage 2: Complete
   âš ï¸  WARNING: Still missing critical fields: valid_until 
      [38] Gardrops KazancÄ±n, CEPTETEB ile 2 S... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [39/56]: https://www.teb.com.tr/sizin-icin/walkersapp/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9519 tokens (P: 8962, C: 557) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
   âš ï¸  Brand Lookup Failed: "WalkersApp"
      ğŸ·ï¸  Generic campaign detected: "CEPTETEB'lilere WalkersApp'ten 2500 Walkers Puan Hediye!"
      [39] CEPTETEB'lilere WalkersApp'ten 2500... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [40/56]: https://www.teb.com.tr/sizin-icin/wastelog/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9516 tokens (P: 8974, C: 542) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
   âš ï¸  Brand Lookup Failed: "Waste Log"
      [40] AtÄ±klarÄ±nÄ± Waste Log Ä°le Geri DÃ¶nÃ¼ÅŸ... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [41/56]: https://www.teb.com.tr/sizin-icin/0-faiz-tna/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9780 tokens (P: 9109, C: 671) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [41] %0 Faizli Taksitli Nakit Avans FÄ±rs... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [42/56]: https://www.teb.com.tr/sizin-icin/otomate-1000/
   gemini-2.0-flash Stage 1: Full parse...
   ğŸ“Š AI Usage: 9134 tokens (P: 8626, C: 508)
   âœ… Stage 1: Complete (all fields extracted)
      [42] CEPTETEB'lilere Otomate'de 1000 TL ... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [43/56]: https://www.teb.com.tr/sizin-icin/osevio/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9325 tokens (P: 8845, C: 480) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
   âš ï¸  Validation errors detected:
      ğŸš¨ Matematiksel tutarsÄ±zlÄ±k! discount_percentage=15 ama min_spend=NULL
   ğŸ”„ Triggering Surgical Parse to fix issues...
   ğŸ“Š AI Usage: 1387 tokens (P: 1284, C: 103) [PYTHON]
   ğŸ†• New brands detected: Osevio
   âœ… Added new brand: Osevio
   âš ï¸  WARNING: Still has validation errors after surgical fix:
      ğŸš¨ Matematiksel tutarsÄ±zlÄ±k! discount_percentage=15 ama min_spend=NULL
      [43] Osevio.com'da %15 Ä°ndirim!... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [44/56]: https://www.teb.com.tr/sizin-icin/e-sim/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9346 tokens (P: 8784, C: 562) [PYTHON]
   ğŸ”„ Stage 2: Filling missing fields: min_spend 
   ğŸ“Š AI Usage: 1111 tokens (P: 1095, C: 16) [PYTHON]
   âœ… Stage 2: Complete
   âš ï¸  WARNING: Still missing critical fields: min_spend 
      [44] CEPTETEB'lilere Yurt DÄ±ÅŸÄ± E-Sim Pak... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [45/56]: https://www.teb.com.tr/sizin-icin/n11-indirim/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9618 tokens (P: 9067, C: 551) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [45] Mastercard Logolu TEB Kredi Kartlar... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [46/56]: https://www.teb.com.tr/sizin-icin/google-play-indirim/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9521 tokens (P: 9039, C: 482) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [46] Mastercard Logolu TEB KartlarÄ±nÄ±z i... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [47/56]: https://www.teb.com.tr/sizin-icin/starbucks/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9782 tokens (P: 9132, C: 650) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [47] TEB Kredi KartlarÄ±nÄ±zla Starbucks't... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [48/56]: https://www.teb.com.tr/sizin-icin/tikla-gelsin/
   gemini-2.0-flash Stage 1: Full parse...
   ğŸ“Š AI Usage: 9149 tokens (P: 8533, C: 616)
   âœ… Stage 1: Complete (all fields extracted)
      [48] Mastercard Logolu TEB Kredi Kartlar... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [49/56]: https://www.teb.com.tr/sizin-icin/yeni-mevduat-vadeli/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 10424 tokens (P: 9531, C: 893) [PYTHON]
   ğŸ”„ Stage 2: Filling missing fields: valid_until 
   ğŸ“Š AI Usage: 1858 tokens (P: 1842, C: 16) [PYTHON]
   âœ… Stage 2: Complete
   âš ï¸  WARNING: Still missing critical fields: valid_until 
      [49] Yeni MevduatÄ±nÄ±za %38'e Varan Faiz ... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [50/56]: https://www.teb.com.tr/sizin-icin/ikea/
   gemini-2.0-flash Stage 1: Full parse...
   ğŸ“Š AI Usage: 9139 tokens (P: 8599, C: 540)
   âœ… Stage 1: Complete (all fields extracted)
      ğŸ·ï¸  Generic campaign detected: "Mastercard Logolu TEB Kredi KartlarÄ±nÄ±zla IKEA'da GeÃ§erli 1.000 TL Ä°ndirim"
      [50] Mastercard Logolu TEB Kredi Kartlar... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [51/56]: https://www.teb.com.tr/sizin-icin/ulasim-150-indirim/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9697 tokens (P: 9125, C: 572) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [51] Toplu TaÅŸÄ±ma HarcamalarÄ±nÄ±za 150 TL... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [52/56]: https://www.teb.com.tr/sizin-icin/ooautos/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 10927 tokens (P: 8913, C: 2014) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
   âš ï¸  Validation errors detected:
      ğŸš¨ Matematiksel tutarsÄ±zlÄ±k! discount_percentage=20 ama min_spend=NULL
   ğŸ”„ Triggering Surgical Parse to fix issues...
   ğŸ“Š AI Usage: 1458 tokens (P: 1356, C: 102) [PYTHON]
   âš ï¸  WARNING: Still has validation errors after surgical fix:
      ğŸš¨ Matematiksel tutarsÄ±zlÄ±k! discount_percentage=20 ama min_spend=NULL
      [52] CEPTETEB'liler ooAutos'da Ã‡ok Avant... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [53/56]: https://www.teb.com.tr/sizin-icin/servisplan/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 10013 tokens (P: 9180, C: 833) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
   âš ï¸  Validation errors detected:
      ğŸš¨ Matematiksel tutarsÄ±zlÄ±k! discount_percentage=32 ama min_spend=NULL
   ğŸ”„ Triggering Surgical Parse to fix issues...
   ğŸ“Š AI Usage: 1734 tokens (P: 1618, C: 116) [PYTHON]
   ğŸ†• New brands detected: Euromaster, Witty Car
   âœ… Added new brand: Euromaster
   âœ… Added new brand: Witty Car
   âš ï¸  WARNING: Still has validation errors after surgical fix:
      ğŸš¨ Matematiksel tutarsÄ±zlÄ±k! discount_percentage=32 ama min_spend=NULL
      [53] Servis Plan ile Lastik DeÄŸiÅŸimi Ã‡ok... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [54/56]: https://www.teb.com.tr/sizin-icin/enuygun-ucak/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 9673 tokens (P: 8920, C: 753) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [54] ENUYGUN'dan CEPTETEB'lilere Ã–zel UÃ§... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [55/56]: https://www.teb.com.tr/sizin-icin/enuygun-otel-indirim/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 19073 tokens (P: 9000, C: 841) [PYTHON]
   âœ… Stage 1: Complete (all fields extracted)
      [55] Otel RezervasyonlarÄ±nda %10 Ä°ndirim... (Img: âœ…)
      âœ… Successfully saved/updated.
   ğŸ” Processing [56/56]: https://www.teb.com.tr/sizin-icin/enuygun-arac-y10-indirim/
   gemini-2.0-flash [PYTHON] Stage 1: Full parse...
   ğŸ“Š AI Usage: 83470 tokens (P: 8841, C: 7772) [PYTHON]
   ğŸ”„ Stage 2: Filling missing fields: valid_until, min_spend 
   ğŸ“Š AI Usage: 1190 tokens (P: 1155, C: 35) [PYTHON]
   ğŸ¦ Bank service detected for "ENUYGUN'dan CEPTETEB'lilere Ã–zel %10 AraÃ§ Kiralama Ä°ndirimi!", mapping to "Genel"
   âœ… Stage 2: Complete
   âš ï¸  WARNING: Still missing critical fields: min_spend 
      [56] ENUYGUN'dan CEPTETEB'lilere Ã–zel Ar... (Img: âœ…)
      âœ… Successfully saved/updated.

âœ… TEB Scraper Finished. Processed 56 campaigns.
